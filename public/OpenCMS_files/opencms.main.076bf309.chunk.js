(this["webpackJsonpopencms-main-qiankun"]=this["webpackJsonpopencms-main-qiankun"]||[]).push([[0],{122:function(e,t,n){e.exports={cmsDefaultLayout:"cmsDefaultLayout__3GPhI",cmsDefaultLayoutContent:"cmsDefaultLayoutContent__3R_ui",breadcrumb:"breadcrumb__3EoLg",breadcrumbContent:"breadcrumbContent__1OfYq"}},301:function(e,t,n){},356:function(e,t,n){},357:function(e,t,n){},506:function(e,t,n){},507:function(e,t,n){"use strict";n.r(t);n(160);var a=n(33),r=n(0),o=n.n(r),c=n(26),i=n.n(c),s=n(185),u=n(28),l=(n(273),n(250)),d=(n(125),n(41)),p=(n(276),n(105)),m=(n(279),n(192)),b=(n(281),n(187)),h=n(58),f=n(59),j=n(61),v=n(60),g=n(246),O=n.n(g),x=n(247),y=n.n(x),w=["200",200,0,"0","ok","true"],N=y.a.debounce((function(){a.b.error("\u60a8\u7684\u767b\u5f55\u72b6\u6001\u5df2\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55"),setTimeout((function(){window.location.href="/webapp/login?redirect=".concat(location.pathname+location.search)}),1e3)}),100),S=function(e,t){switch(e){case 401:N();break;case 403:case 404:case 406:a.b.error("\u670d\u52a1\u5668\u5f02\u5e38".concat(e));break;default:a.b.error("\u670d\u52a1\u5668\u5f02\u5e38".concat(e)),console.log(t,"msg")}},k=O.a.create({timeout:3e3});k.interceptors.request.use((function(e){return e.withCredentials=!0,e}),(function(e){return Promise.reject(e)})),k.interceptors.response.use((function(e){if(e.status&&200===e.status&&(w.indexOf(e.data.status)>-1||w.indexOf(e.data.code)>-1))return Promise.resolve(e.data);var t=e.data||{},n=t.msg||t.message;return"401001"===t.status?S(401,n):a.b.error(n||"\u64cd\u4f5c\u5931\u8d25"),Promise.reject(e)}),(function(e){var t=e.response,n=e.message;return t?(S(t.status,t.data.message),Promise.reject(t)):(console.warn(n),n&&n.indexOf("timeout")>-1?(a.b.error("\u8bf7\u6c42\u8d85\u65f6\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"),Promise.reject(e)):(window.navigator.onLine||a.b.error("\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u60a8\u7684\u7f51\u7edc\u8fde\u63a5\u60c5\u51b5"),Promise.reject(e)))}));var _=k;function C(e){return _.get("/base/authority/get_menu_list",{params:e,timeout:1e4})}function R(e){return _.get("/base/login/get_login_code",{params:e})}function P(e){return _.post("/base/user/login",e)}function I(){return _.post("/base/user/login_out")}function F(){return location.href.includes("login")?{}:_.get("/base/waterPng",{timeout:1e4})}var M=n(513),L=n(515),D=n(151);function B(){return window.location.origin}function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:location.search,t=(e||"").replace("?",""),n={};return t.split("&").map((function(e){var t=e.split("="),a=Object(D.a)(t,2),r=a[0],o=a[1];return n[r]=o,e})),n}n(205),n(301);var z=n(9),q=function(e){Object(j.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(h.a)(this,n);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];(e=t.call.apply(t,[this].concat(c))).formRef=o.a.createRef(),e.getVerification=function(){R({phone:e.state.phoneNum}).then((function(t){if("200"===t.status){a.b.success("\u9a8c\u8bc1\u7801\u5df2\u53d1\u9001\uff0c\u8bf7\u6ce8\u610f\u67e5\u6536"),e.setState({leftSeconds:59});var n=setInterval((function(){if(e.state.leftSeconds<=0)return clearInterval(n),void e.setState({leftSeconds:-1});e.setState((function(e){return{leftSeconds:e.leftSeconds-1}}))}),1e3);localStorage.setItem("responseId",t.data.reponse_id)}else e.setState({leftSeconds:-1}),a.b.error(t.msg)})).catch((function(){e.setState({leftSeconds:-1})}))},e.onFinish=function(t){var n=new FormData;n.append("username",t.username),n.append("password",t.password),e.setState({responseId:localStorage.getItem("responseId")}),n.append("response_id",e.state.responseId),P(n).then((function(e){if("200"===e.status){var t=B();window.location.href=t+"/webapp/main/admin",a.b.success("\u767b\u5f55\u6210\u529f")}else a.b.error(e.msg)})).catch((function(e){console.log(e)}))},e.handlePhoneNum=function(t){e.setState({phoneNum:t}),e.validateForm()},e.validateForm=function(){var t;null===(t=e.formRef.current)||void 0===t||t.validateFields().then((function(){return e.setState({loginButtonDisabled:!1})})).catch((function(){return e.setState({loginButtonDisabled:!0})}))},e.handlePasswordChange=function(t){e.setState({verficationNum:t}),e.validateForm()},e.onFinishFailed=function(){console.log("Failed:")};var s=e.props.location,u=void 0===s?{}:s;console.log("LoginPage constructor:",e.props);var l=u.state||{from:{pathname:"/"}},d=l.from;return e.state={pageFrom:d,phoneNum:"",verficationNum:"",leftSeconds:-1,loginButtonDisabled:!1,cookie:"token"},e}return Object(f.a)(n,[{key:"render",value:function(){var e=this;return console.log("LoginPage render"),Object(z.jsx)("div",{className:"container",children:Object(z.jsx)("div",{className:"box",children:Object(z.jsxs)(l.a,{children:[Object(z.jsx)(b.a,{span:12,children:Object(z.jsx)("div",{className:"imgBox",children:Object(z.jsx)("img",{src:"http://pages.anjukestatic.com/usersite/pc/anjuhao/defaultLogin.png",alt:""})})}),Object(z.jsx)(b.a,{span:12,children:Object(z.jsxs)("div",{className:"loginBox",children:[Object(z.jsx)("div",{className:"title",children:"OPENCMS"}),Object(z.jsxs)(p.a,{name:"basic",ref:this.formRef,onFinish:this.onFinish,onFinishFailed:this.onFinishFailed,children:[Object(z.jsx)(p.a.Item,{className:"username",name:"username",rules:[{required:!0,message:"\u8bf7\u586b\u5199\u624b\u673a\u53f7\uff01"},function(){return{validator:function(e,t){return!t||/^1[0|2|3|4|5|6|7|8|9][0-9]{9}$/.test(t)?Promise.resolve():Promise.reject(new Error("\u624b\u673a\u53f7\u683c\u5f0f\u4e0d\u5bf9\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"))}}}],children:Object(z.jsx)(m.a,{className:"inputstyle",value:this.state.phoneNum,onChange:function(t){e.handlePhoneNum(t.target.value)},prefix:Object(z.jsx)(M.a,{className:"site-form-item-icon"}),placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801"})}),Object(z.jsx)(p.a.Item,{className:"password",name:"password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801\uff01"},{pattern:/^[0-9]{6}$/,message:"\u8bf7\u8f93\u51656\u4f4d\u9a8c\u8bc1\u7801"}],children:Object(z.jsx)(m.a,{className:"inputstyle verficationCode",autoComplete:"off",prefix:Object(z.jsx)(L.a,{className:"site-form-item-icon"}),onChange:function(t){e.handlePasswordChange(t.target.value)},maxLength:6,value:this.state.verficationNum,placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u52a8\u6001\u7801"})}),Object(z.jsxs)(d.a,{type:"text",className:"verficationNum",disabled:11!==this.state.phoneNum.length||this.state.leftSeconds>0&&this.state.leftSeconds,onClick:this.getVerification,children:["\u83b7\u53d6\u9a8c\u8bc1\u7801",this.state.leftSeconds>0&&this.state.leftSeconds]}),Object(z.jsx)(p.a.Item,{children:Object(z.jsx)(d.a,{color:"green",disabled:!this.state.phoneNum||!this.state.verficationNum||this.state.loginButtonDisabled,htmlType:"submit",className:"login-form-button",children:"\u767b\u5f55"})}),Object(z.jsx)(p.a.Item,{})]})]})})]})})})}}]),n}(r.Component),T=Object(u.f)(q),A=n(80),K=(n(356),function(e){Object(j.a)(n,e);var t=Object(v.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(f.a)(n,[{key:"render",value:function(){var e=this.props.loading;return Object(z.jsxs)(z.Fragment,{children:[e&&Object(z.jsx)("h4",{className:"subapp-loading",children:"Loading..."}),Object(z.jsx)("div",{id:"subapp-viewport",style:{height:"100%"}})]})}}]),n}(r.Component)),J=n(512),V=n(260),U=n(511),W=(n(357),n(173),n(86)),Q=n(193),Y=n(190),G=n(262),X={navTheme:"light",primaryColor:"#1890ff",layout:"mix",contentWidth:"Fluid",fixedHeader:!1,fixSiderbar:!0,colorWeak:!1,title:"OpenCMS",pwa:!1,logo:"https://wos2.58cdn.com.cn/DeFazYxWvDti/frsupload/15f65c8152d7d5c81e3b236543137bfa_cmslogo.svg",iconfontUrl:"",beidouPid:133},$=X,H=n(257),Z=(n(361),n(265)),ee=(n(219),n(150)),te=(n(135),n(38)),ne=(n(366),n(263)),ae=n(514),re=(n(218),n(251)),oe=function(e){var t=Object.assign({},e);return Object(z.jsx)(re.a,Object(A.a)({},t))},ce=oe;function ie(e,t,n){var a=new Date;a.setTime(a.getTime()+24*n*60*60*1e3);var r="expires="+a.toUTCString();document.cookie=e+"="+t+"; "+r}function se(e){for(var t=e+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){var r=n[a].trim();if(0===r.indexOf(t))return r.substring(t.length,r.length)}return""}var ue=n(81),le=n.n(ue),de=function(){I().then((function(){window.location.href=location.origin+"/webapp/login?redirect=".concat(location.pathname+location.search)}))},pe=function(){ie("token","",0),localStorage.removeItem("menu"),ne.a.confirm({title:"\u786e\u5b9a\u9000\u51fa\u767b\u5f55\u5417?",content:"",okText:"\u786e\u5b9a",okType:"primary",cancelText:"\u53d6\u6d88",onOk:function(){de()},onCancel:function(){console.log("Cancel")}})},me=function(){var e=Object(z.jsx)(te.a,{className:le.a.menu,selectedKeys:[],onClick:function(e){var t=e.key;console.warn(t),"logout"===t&&pe()},children:Object(z.jsxs)(te.a.Item,{children:[Object(z.jsx)(ae.a,{}),"\u9000\u51fa\u767b\u5f55"]},"logout")});return Object(z.jsx)(ce,{overlay:e,children:Object(z.jsxs)("span",{className:"".concat(le.a.action," ").concat(le.a.account),children:[Object(z.jsx)(ee.a,{size:"small",className:le.a.avatar,src:"https://pic1.58cdn.com.cn/nowater/fangfe/n_v2bf8df92f6ed54b8cb6ccacd446299724.png",alt:"avatar"}),Object(z.jsx)("span",{className:"".concat(le.a.name," anticon"),children:""})]})})},be=me,he=function(){return Object(z.jsx)(Z.b,{className:le.a.right,children:Object(z.jsx)(be,{})})},fe=he,je=n(122),ve=n.n(je),ge=function(e){Object(j.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={leftMenu:[],breadcrumb:[],menu:[],currentPathName:"",collapsed:!1},e.getMenuQuery=function(){C({}).then((function(t){e.setState({menu:e.filterVisibleMenu(t.data)}),localStorage.setItem("menu",JSON.stringify(t.data));var n=e.filterPages(t.data),a=e.findMenuPath(n,location.pathname);e.setState({breadcrumb:a,currentPathName:location.pathname})}))},e.filterPages=function(t){var n=[];if(t){var a,r=Object(Y.a)(t);try{for(r.s();!(a=r.n()).done;){var o=a.value;[2,3,5].includes(o.authority_type)||n.push({pathKey:o.key,path:o.url||"/",name:o.title,children:e.filterPages(o.children)})}}catch(c){r.e(c)}finally{r.f()}return n}},e.filterVisibleMenu=function(t){var n=[];return(t||[]).map((function(t){return[2,3,5,6].includes(t.authority_type)||n.push({pathKey:t.key,path:t.url||"/",name:t.title,children:e.filterVisibleMenu(t.children)}),t})),n},e.findMenuPath=function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=Object(Y.a)(n);try{for(o.s();!(t=o.n()).done;){var c=t.value,i=[];if((i=c.path!==a||c.children&&c.children.length?c.children&&c.children.length?e.findMenuPath(c.children,a,[].concat(Object(Q.a)(r),[c])):[]:[].concat(Object(Q.a)(r),[c])).length)return i}}catch(s){o.e(s)}finally{o.f()}return[]},e.clickMenuItem=function(t){"/"===t.path&&(t.path="/webapp/main/404");var n=e.findMenuPath(e.state.menu,t.path);e.setState({breadcrumb:n,currentPathName:t.path.includes("?")?t.path.split("?")[0]:t.path}),t.path&&window.history.pushState("","",t.path)},e.onCollapse=function(t){e.setState({collapsed:t})},e}return Object(f.a)(n,[{key:"componentDidMount",value:function(){this.getMenuQuery(),this.setState({currentPathName:location.pathname})}},{key:"render",value:function(){var e=this,t=this.props,n=t.showBreadcrumb,a=t.footerRender,r=t.menuRender,o=t.headerRender;r||($.menuRender=!1),o||($.headerRender=!1);var c=this.state,i=c.menu,s=c.currentPathName,u=c.breadcrumb,l={path:"/",routes:i};return Object(z.jsx)(z.Fragment,{children:Object(z.jsx)(G.a,Object(A.a)(Object(A.a)({className:ve.a.cmsDefaultLayout},$),{},{route:l,location:{pathname:s},menuItemRender:function(t,n){return Object(z.jsx)("a",{onClick:function(){return e.clickMenuItem(t)},children:n})},rightContentRender:function(){return Object(z.jsx)(fe,{})},footerRender:function(){return a?Object(z.jsxs)(H.Footer,{style:{textAlign:"center",padding:"0 0 12px"},children:["OpenCMS - \u540e\u53f0\u7ba1\u7406\u7cfb\u7edf \xa9",(new Date).getFullYear()," Created by \u5b89\u5c45\u5ba2"]}):""},collapsed:!1,collapsedButtonRender:!1,breakpoint:!1,children:Object(z.jsxs)("div",{className:ve.a.cmsDefaultLayoutContent,children:[n&&u&&u.length?Object(z.jsx)("div",{className:ve.a.breadcrumbContent,children:Object(z.jsx)(W.a,{className:ve.a.breadcrumb,children:(u||[]).map((function(e){return Object(z.jsx)(W.a.Item,{children:e.title||e.name},e.pathKey)}))})}):"",this.props.children]})}))})}}]),n}(o.a.Component),Oe=Object(u.f)(ge),xe=["//s.anjuke.com/","//webapi.amap.com/"],ye=function(e){var t=window.location.hostname,n=window.location.pathname;return[{name:"subapp-main",activeRule:"/webapp/main",entry:"//".concat(t,"/subapp/main")},{name:"subapp-qhy",activeRule:"/webapp/qhy",entry:"//".concat(t,"/subapp/qhy")},{name:"subapp-sydc",activeRule:"/webapp/sydc",entry:"//".concat(t,"/subapp/sydc")},{name:"subapp-vr",activeRule:"/webapp/vr",entry:"//".concat(t,"/subapp/vr")},{name:"subapp-yezhu",activeRule:"/webapp/yezhu",entry:"//".concat(t,"/subapp/yezhu")},{name:"subapp-bizdata",activeRule:"/webapp/bizdata",entry:"//".concat(t,"/subapp/bizdata")}].map((function(t){return{name:t.name,entry:t.entry+n.replace(t.activeRule,""),container:"#subapp-viewport",loader:e,activeRule:t.activeRule}}))},we=function(e){Object(j.a)(n,e);var t=Object(v.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).state={loading:!1,subLoader:null},a}return Object(f.a)(n,[{key:"componentDidMount",value:function(){var e=function(e){var t=document.getElementById("subapp-container");i.a.render(Object(z.jsx)(K,{loading:e}),t)};this.setState({loading:!0,subLoader:e});var t=ye(e);Object(J.b)(t,{beforeLoad:[function(e){return new Promise((function(t){console.log("[LifeCycle] before load %c%s","color: green;",e.name),t(e.name)}))}],beforeMount:[function(e){return new Promise((function(t){console.log("[LifeCycle] before mount %c%s","color: green;",e.name),t(e.name)}))}],afterUnmount:[function(e){console.log("[LifeCycle] after unmount %c%s","color: green;",e.name)}]}),(0,Object(V.b)({user:"qiankun"}).setGlobalState)({appName:"OpenCMS",ignore:"master"}),Object(J.c)({prefetch:!1,excludeAssetFilter:function(e){return!!xe.find((function(t){return e.includes(t)}))}}),Object(U.a)((function(){console.log("[MainApp] first app mounted")}))}},{key:"render",value:function(){var e=E(),t="0"!==e.breadcrumb,n="0"!==e.footerRender,a="0"!==e.menuRender,r="0"!==e.headerRender;console.warn("render home:",e);var o={showBreadcrumb:t,footerRender:n,menuRender:a,headerRender:r};return Object(z.jsx)(Oe,Object(A.a)(Object(A.a)({},o),{},{children:Object(z.jsx)("div",{id:"subapp-container",className:"view",style:{flex:1}})}))}}]),n}(r.Component),Ne=we,Se=function(e){Object(j.a)(n,e);var t=Object(v.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).state={error:!1,errorInfo:!1},console.log("===============ErrorBoundary=============="),a}return Object(f.a)(n,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t}),window.Beidou&&window.Beidou.captureException(e,t)}},{key:"render",value:function(){return this.state.errorInfo?Object(z.jsx)("div",{children:Object(z.jsx)("div",{children:"\u54ce\u5440\uff5e\u51fa\u9519\u5566\uff01\u8bf7\u8054\u7cfb\u5f00\u53d1\u4eba\u5458"})}):Object(z.jsx)(z.Fragment,{children:this.props.children})}}]),n}(o.a.Component),ke=Se,_e=function(){return Object(z.jsx)(ke,{children:Object(z.jsx)(s.a,{basename:"/webapp",children:Object(z.jsxs)(u.c,{children:[Object(z.jsx)(u.a,{path:"/login",component:T}),Object(z.jsx)(u.a,{path:"/admin",children:Object(z.jsx)(Ne,{})}),Object(z.jsx)(u.a,{path:"*",children:Object(z.jsx)(Ne,{})})]})})})},Ce=_e,Re=n(104),Pe=n.n(Re),Ie=n(261),Fe="undefined"===typeof arguments?void 0:arguments,Me=function(){var e=Object(Ie.a)(Pe.a.mark((function e(){var t,n,a,r,o,c,i,s,u,l,d,p,m=arguments;return Pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.length>0&&void 0!==m[0]?m[0]:{},n=t.container,a=void 0===n?document.body:n,r=t.zIndex,o=void 0===r?1e5:r,e.next=3,F();case 3:if((c=e.sent).data){e.next=6;break}return e.abrupt("return",!1);case 6:i=c.data,s=document.querySelector(".__wm"),u=s||document.createElement("div"),l="\n    position:fixed;\n    top:0;\n    left:0;\n    right:0;\n    bottom:0;\n    width:100%;\n    height:100%;\n    z-index:".concat(o,";\n    pointer-events:none;\n    background-repeat:repeat;\n    background-image:url('data:image/png;base64,").concat(i,"')"),u.setAttribute("style",l),u.classList.add("__wm"),s||a.insertBefore(u,a.firstChild),(d=window.MutationObserver||window.WebKitMutationObserver)&&(p=new d((function(){var e=document.querySelector(".__wm");if(e&&e.getAttribute("style")!==l||!e){p.disconnect(),p=null;var t=Object(D.a)(Fe,1)[0];Me(JSON.parse(JSON.stringify(t)))}})),p.observe(a,{attributes:!0,subtree:!0,childList:!0}));case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Le=Me,De=n(264);n(506);Le(),Object(De.a)({onRequest:function(e,t){e.url.indexOf("opencms.anjuke.")>-1&&(e.headers["X-CSRF-TOKEN"]=se("stoken"),e.headers["X-AJK-CSRF-TOKEN"]=se("ajk_probe_token")),t.next(e)},onError:function(e,t){e&&e.error&&"timeout"===e.error.type?a.b.error("\u8bf7\u6c42\u8d85\u65f6\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"):t.next(e)},onResponse:function(e,t){t.next(e)}});var Be=["Error:ResizeObserver loop limit exceeded","Error:ResizeObserver loop completed with undelivered notifications","Error:Script error","UnhandledRejection:Non-Error"],Ee=function(){var e=(location.pathname||"").match(/^\/webapp\/[a-z]+/);return e&&e[0]&&{"/webapp/main":134,"/webapp/sydc":239,"/webapp/vr":192,"/webapp/qhy":221,"/webapp/yezhu":349,"/webapp/bizdata":150}[e[0]]||$.beidouPid};window.Beidou&&window.Beidou.init({projectId:$.beidouPid,isProd:!0,isDebug:!1,ignoreErrors:Be,beforeSend:function(e){return"breadcrumb"===e.type||(e.projectId=Ee(),e.type&&"exception"===e.type&&console.warn("beidou\u53d1\u73b0\u5f02\u5e38\uff0c\u51c6\u5907\u4e0a\u62a5",e)),e}}),i.a.render(Object(z.jsx)(Ce,{}),document.getElementById("root"))},81:function(e,t,n){e.exports={menu:"menu__3FhhC",right:"right__1Cdbx",action:"action__pvrD5",search:"search__3RT4T",account:"account__vR6MA",avatar:"avatar__rQVJ6",name:"name__35bfx",dark:"dark__27MRE"}}},[[507,1,2]]]);
//# sourceMappingURL=opencms.main.076bf309.chunk.js.map